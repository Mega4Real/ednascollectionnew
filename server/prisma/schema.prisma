generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")

}

model Product {
  id          Int      @id @default(autoincrement())
  imageUrl    String
  videoUrl    String?
  price       Float
  sizes       String[]
  position    Int      @default(0)
  isSold      Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  orderItems  OrderItem[]
}

model Order {
  id              Int         @id @default(autoincrement())
  customerName    String
  email           String
  phone           String
  address         String
  city            String
  totalAmount     Float
  status          String      @default("PENDING") // PENDING, PAID, COMPLETED, CANCELLED
  paymentReference String?
  paymentMethod   String      @default("WHATSAPP") // PAYSTACK, WHATSAPP, CASH
  items           OrderItem[]
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
}

model OrderItem {
  id        Int     @id @default(autoincrement())
  orderId   Int
  order     Order   @relation(fields: [orderId], references: [id])
  productId Int
  product   Product @relation(fields: [productId], references: [id])
  size      String
  price     Float
}

model Admin {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  password  String
  createdAt DateTime @default(now())
}

model DiscountCode {
  id          Int      @id @default(autoincrement())
  code        String   @unique
  type        String   // PERCENTAGE or FIXED
  value       Float
  minQuantity Int      @default(1)
  usageLimit  Int?     // Null means unlimited
  usedCount   Int      @default(0)
  expiresAt   DateTime?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model SiteSettings {
  id        Int      @id @default(autoincrement())
  key       String   @unique
  value     String
  updatedAt DateTime @updatedAt
}
